# نظام الإشعارات عبر البريد الإلكتروني - Infinity Wear

## نظرة عامة

تم تطوير نظام شامل لإدارة الإشعارات عبر البريد الإلكتروني في نظام Infinity Wear. يتيح هذا النظام للمديرين التحكم الكامل في إعدادات البريد الإلكتروني وتلقي الإشعارات الفورية عند حدوث أحداث مهمة في النظام.

## الميزات الرئيسية

### 1. إعدادات البريد الإلكتروني المتقدمة
- **إعدادات SMTP**: خادم البريد، المنفذ، التشفير
- **معلومات المرسل**: البريد الإلكتروني واسم المرسل
- **بريد المدير**: البريد الإلكتروني الذي سيستقبل الإشعارات
- **اختبار البريد**: إمكانية إرسال بريد تجريبي للتحقق من الإعدادات

### 2. أنواع الإشعارات المدعومة
- **طلبات جديدة**: إشعارات عند استلام طلبات جديدة
- **رسائل الاتصال**: إشعارات عند استلام رسائل من نموذج الاتصال
- **رسائل الواتساب**: إشعارات عند استلام رسائل واتساب جديدة
- **طلبات المستوردين**: إشعارات عند استلام طلبات من المستوردين
- **إشعارات النظام**: إشعارات عامة من النظام

### 3. إعدادات متقدمة
- **تفعيل/إلغاء تفعيل الإشعارات**: تحكم كامل في تفعيل الإشعارات
- **طابور الإرسال**: إمكانية إرسال الإيميلات في الخلفية
- **حد الإرسال**: تحديد عدد الإيميلات المسموح إرسالها في الدقيقة
- **إعادة تعيين الإعدادات**: إعادة الإعدادات للقيم الافتراضية

## الملفات المضافة/المحدثة

### 1. قاعدة البيانات
- **Migration**: `2025_10_07_140537_create_notification_settings_table.php`
- **Model**: `app/Models/NotificationSetting.php`
- **Seeder**: `database/seeders/NotificationSettingsSeeder.php`

### 2. Controllers
- **Controller**: `app/Http/Controllers/Admin/NotificationSettingsController.php`

### 3. Mail Classes
- `app/Mail/OrderNotificationMail.php`
- `app/Mail/ContactNotificationMail.php`
- `app/Mail/WhatsAppNotificationMail.php`
- `app/Mail/SystemNotificationMail.php`

### 4. Email Templates
- `resources/views/emails/order-notification.blade.php`
- `resources/views/emails/contact-notification.blade.php`
- `resources/views/emails/whatsapp-notification.blade.php`
- `resources/views/emails/system-notification.blade.php`

### 5. Views
- `resources/views/admin/notifications/settings.blade.php`

### 6. Services
- **محدث**: `app/Services/NotificationService.php`

### 7. Routes
- **محدث**: `routes/web.php`

## كيفية الاستخدام

### 1. الوصول لإعدادات الإشعارات
```
http://127.0.0.1:8000/admin/notifications/settings
```

### 2. إعداد البريد الإلكتروني
1. انتقل إلى صفحة إعدادات الإشعارات
2. أدخل إعدادات SMTP (Gmail مثال):
   - **خادم SMTP**: `smtp.gmail.com`
   - **المنفذ**: `587`
   - **التشفير**: `TLS`
   - **اسم المستخدم**: بريدك الإلكتروني
   - **كلمة المرور**: كلمة مرور التطبيق
3. أدخل بريد المرسل وبريد المدير
4. فعّل الإشعارات المطلوبة
5. احفظ الإعدادات

### 3. اختبار الإعدادات
1. أدخل بريد إلكتروني للاختبار
2. اضغط على "إرسال بريد تجريبي"
3. تحقق من وصول البريد

## إعدادات Gmail

### 1. تفعيل كلمة مرور التطبيق
1. انتقل إلى إعدادات Google Account
2. اذهب إلى Security
3. فعّل 2-Step Verification
4. أنشئ App Password
5. استخدم كلمة مرور التطبيق في الإعدادات

### 2. إعدادات SMTP الموصى بها
```
Host: smtp.gmail.com
Port: 587
Encryption: TLS
Username: your-email@gmail.com
Password: your-app-password
```

## الأمان

### 1. حماية كلمات المرور
- يتم تشفير كلمات مرور SMTP في قاعدة البيانات
- لا يتم عرض كلمات المرور في واجهة المستخدم

### 2. التحقق من الصلاحيات
- جميع الصفحات محمية بـ admin middleware
- التحقق من صحة البيانات المدخلة

### 3. تسجيل العمليات
- يتم تسجيل جميع عمليات تحديث الإعدادات
- تسجيل محاولات إرسال البريد الإلكتروني

## استكشاف الأخطاء

### 1. مشاكل الاتصال بـ SMTP
- تأكد من صحة إعدادات SMTP
- تحقق من كلمة مرور التطبيق
- تأكد من تفعيل 2-Step Verification

### 2. مشاكل إرسال البريد
- تحقق من سجلات النظام
- تأكد من تفعيل الإشعارات
- تحقق من إعدادات Firewall

### 3. مشاكل القوالب
- تأكد من وجود ملفات القوالب
- تحقق من صحة البيانات المرسلة

## التطوير المستقبلي

### 1. ميزات مقترحة
- **قوالب مخصصة**: إمكانية تخصيص قوالب البريد الإلكتروني
- **جدولة الإرسال**: إمكانية جدولة إرسال الإشعارات
- **إحصائيات مفصلة**: إحصائيات عن معدل الإرسال والنجاح
- **دعم متعدد اللغات**: قوالب باللغة الإنجليزية

### 2. تحسينات الأداء
- **تحسين طابور الإرسال**: استخدام Redis أو Database Queue
- **ضغط القوالب**: تحسين حجم قوالب البريد الإلكتروني
- **تخزين مؤقت**: تخزين مؤقت للإعدادات

## الدعم الفني

في حالة مواجهة أي مشاكل:
1. تحقق من سجلات النظام في `storage/logs/`
2. تأكد من صحة إعدادات قاعدة البيانات
3. تحقق من إعدادات الخادم
4. راجع هذا الدليل للاستكشاف

---

**تم التطوير بواسطة**: نظام Infinity Wear  
**تاريخ التحديث**: أكتوبر 2025  
**الإصدار**: 1.0.0
